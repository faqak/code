## CJ0J 115 Clashmas

菊花的做法比较显然，然后可以考虑以重心为根，这个时候树是一棵“类菊花”，具有 $siz \leq \dfrac n2$ 的性质，可以套用菊花的策略。

具体来说，分讨：

### $n$ 为奇数，并且重心为 `R`

考虑保持原来的重心每次操作后仍为重心。

那么不难发现，一轮（先手后手各执步一次之后），对于重心的限制 $lim = \lfloor \dfrac n2 \rfloor$ 正好减一。

1. 原来有 $2$ 棵 $siz = lim + 1$ 的子树：先手一定会操作一棵，后手操作另一棵即可。
1. 有 $1$ 棵：先手如果没有操作这棵子树，后手操作即可，否则乱取也可以满足 $lim$。
1. 没有：纯乱取。

这样后手可以保证原来的重心始终为重心，最后剩的一定是这个点。

### $n$ 为偶数，并且有某一个重心为 `C`

那么 `C` 一定有策略操作掉某一个点之后使得原来的 `C` 重心点仍为重心，此时就是第一种情况。

### $n$ 为偶数，并且两个重心都是 `R`

此时树被分为对称的两部分，后手通过模仿执步可以使得最终剩下两个 `R`，这样先手无论怎么删都是输。

### $n$ 为奇数，并且重心为 `C`

不难发现，按照第一种情况那样执步，子树中第一次存在 $x$ 使得 $2s_x \gt \sum s$ 的时候，$\sum s = 2s_x - 1$，此时 $s_x = \dfrac n2$。

那么此时树有两个重心，即原来的重心和 $x$，并且先后手切换了。

如果 $x$ 上的字母是 `C`，那么 `C` 就可以通过第三种情况的方式胜出，否则，`R` 可以像第二种情况一样胜出。

那么变成了 `R` 和 `C` 对 $x$ 的争夺，不难发现最优的方式是 `R` 删根为 `C` 的子树，`C` 删根为 `R` 的子树，这样双方都可以保证如果操作后出现了 $x$，$x$ 上的字母一定是自己。

所以，统计根为 `C` 或 `R` 的子树 $siz$ 之和并比较即可。

### $n$ 为偶数，并且只有一个重心，为 `R`

`C` 随便操作一次，重心不会改变，此时变成第四种情况。

## LUOGU 4351

$c = 0$ 很简单，考虑怎么构造一个 $g(i, j) = f(i, j) + \Delta$ 使得 $g(i, j) = ag(i, j - 1) + bg(i - 1, j)$。 

小构造一手可以发现 $\Delta = \dfrac c{a + b - 1}$。

当 $a + b \not\equiv 1$ 的时候按照这个做就好了。

考虑 $a + b \equiv 1$，原式即 $f(i, j) = af(i, j - 1) + (1 - a)f(i - 1, j) + c$，发现左边右边的系数和都是 1，考虑 $\Delta$ 为关于 $i + j$ 的函数，则 $\Delta(i, j) = c + \Delta(i + j - 1)$，那就直接 $\Delta(i, j) = c(i + j)$ 就好了，这样子 $g(i, j) = f(i, j) + c(i + j)$ 就满足 $g(i,j) = ag(i, j - 1) + bg(i - 1,j)$，和 $a + b \not\equiv 1$ 可以一样算。

感觉这个构造 $g$ 的思路很难想。